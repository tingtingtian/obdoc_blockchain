	文章主要介绍了 Web 3.0 应用程序架构与 Web 2.0 的差异，以及以太坊区块链在 Web 3.0 应用中的关键作用和相关技术要点

### 1. **Web 2.0 与 Web 3.0 应用架构对比**
    Web 2.0 应用架构：以 Medium 为例，其架构包括存储用户、文章等数据的数据库，定义业务逻辑的后端代码和确定 UI 逻辑的前端代码，这些都托管在中心化服务器上，用户通过浏览器与应用交互。
    
    Web 3.0 应用架构特点：Web 3.0 应用消除了中间环节，没有中心化数据库和后端服务器。基于以太坊区块链的去中心化状态机构建，通过智能合约定义应用逻辑并部署在该状态机上，前端与智能合约交互实现功能。

![[web 2.0. 应用架构.png]]

![[web 3.0. 应用架构.png]]

### 2. **Web 3.0 应用架构关键要素**
    
    区块链（以太坊）：是全球可访问、由节点网络维护的确定性状态机，状态变化遵循共识规则，数据只能写入不能更新，由网络中的所有节点共同维护。
    智能合约：用 Solidity 或 Vyper 等高级语言编写，运行在以太坊区块链上，定义区块链状态变化逻辑且代码公开可查。
    以太坊虚拟机（EVM）：执行智能合约逻辑，但需将高级语言编译为字节码，因为它不理解高级语言。
    前端：定义 UI 逻辑，与智能合约通信较复杂，需通过连接节点（提供者）实现。节点可自行搭建或使用第三方服务提供的，通过 JSON - RPC 规范保证交互方法统一。读区块链数据无需签名，写数据则需用私钥对交易签名，MetaMask 常用于管理密钥和交易签名，兼具提供者和签名者角色。

![[web 3.0  发布交易需要签名.png]]

### 3. **区块链存储问题与解决方案**
    
    存储成本问题：在以太坊存储数据成本高，用户每次添加新数据需付费。
    解决方案：采用 IPFS、Swarm 等去中心化链下存储方案。IPFS 是分布式文件系统，有 Filecoin 激励层，可通过 Infura、Pinata 等使用；Swarm 激励系统通过以太坊智能合约内置实现，且前端代码可托管在这些存储方案上实现真正去中心化。

![[web 3.0 存储成本比较高，可以通过三方服务使用去中心化链下存储.png]]

![[web 3.0 去中心链下存储前端代码，避免应用被审查.png]]

### 4. **查询区块链数据的方式**
    智能合约事件：利用 Web3.js 库查询和监听智能合约事件，事件触发时执行回调函数响应动作。
    The Graph：链下索引解决方案，使用 GraphQL 查询语言，可定义索引智能合约、监听事件及函数调用等，便于查询数据且降低延迟，克服智能合约事件方式的局限。

![[web 3.0 克服时间局限.png]]

### 5. **应用扩展解决方案**
	以太坊存在扩展性问题，如高 gas 费和满载区块影响用户体验。Polygon、Optimistic Rollups、zkRollups 等 Layer 2 扩展解决方案将交易执行放在链下，仅存储交易数据在链上，实现区块链扩展，使交易更快、更便宜且必要时与主链通信。

![[web  3.0 扩展解决方案.png]]
### 6. **开发工具**
	Hardhat 等开发者框架有助于以太坊开发者构建、部署和测试智能合约，提供本地网络部署、插件生态和调试功能等便利。